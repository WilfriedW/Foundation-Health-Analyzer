<?xml version="1.0" encoding="UTF-8"?><record_update table="x_1310794_founda_0_issue_rules">
    <x_1310794_founda_0_issue_rules action="INSERT_OR_UPDATE">
        <active>true</active>
        <code>FIELD_CHECK</code>
        <default_severity>medium</default_severity>
        <description>Vérificateur de champ générique avec divers opérateurs. Utilisez params {"field": "active", "operator": "equals", "expected": "false", "message_template": "Message personnalisé"}. Opérateurs: equals, not_equals, contains, not_contains, empty, not_empty, regex, gt, lt, gte, lte.</description>
        <name>Generic Field Check</name>
        <params>{"field":"active","operator":"equals","expected":"false"}</params>
        <script><![CDATA[var field = params.field;
if (!field) return issues;

var value = item.values && item.values[field];
var operator = params.operator || 'equals';
var expected = params.expected;
var recordName = item.values.name || item.values.title || 'Record';

var condition = false;
var actualStr = String(value || '');
var expectedStr = String(expected || '');

switch(operator) {
    case 'equals':
        condition = actualStr === expectedStr;
        break;
    case 'not_equals':
        condition = actualStr !== expectedStr;
        break;
    case 'contains':
        condition = actualStr.indexOf(expectedStr) !== -1;
        break;
    case 'not_contains':
        condition = actualStr.indexOf(expectedStr) === -1;
        break;
    case 'empty':
        condition = !value || value === '';
        break;
    case 'not_empty':
        condition = value && value !== '';
        break;
    case 'regex':
        try {
            var regex = new RegExp(expectedStr);
            condition = regex.test(actualStr);
        } catch(e) {
            gs.warn('[field_check] Invalid regex: ' + expectedStr);
            return issues;
        }
        break;
    case 'gt':
        condition = parseFloat(value) > parseFloat(expected);
        break;
    case 'lt':
        condition = parseFloat(value) < parseFloat(expected);
        break;
    case 'gte':
        condition = parseFloat(value) >= parseFloat(expected);
        break;
    case 'lte':
        condition = parseFloat(value) <= parseFloat(expected);
        break;
    default:
        gs.warn('[field_check] Unknown operator: ' + operator);
        return issues;
}

if (condition) {
    var message = params.message_template || 
        'Champ "' + field + '" ' + operator + ' "' + expectedStr + '" dans "' + recordName + '"';
    
    issues.push({
        code: rule.code,
        message: message,
        severity: rule.severity || 'medium',
        details: {
            field: field,
            operator: operator,
            expected: expectedStr,
            actual: actualStr,
            record_table: item.table,
            record_sys_id: item.sys_id,
            record_name: recordName
        }
    });
}]]></script>
        <severity>medium</severity>
        <sys_class_name>x_1310794_founda_0_issue_rules</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-01-18 12:00:00</sys_created_on>
        <sys_id>aaaa0007feed53163610c7233ee0a049</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Generic Field Check</sys_name>
        <sys_package display_value="Foundation Health Analyzer" source="x_1310794_founda_0">d852994c8312321083e1b4a6feaad3e6</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Foundation Health Analyzer">d852994c8312321083e1b4a6feaad3e6</sys_scope>
        <sys_update_name>x_1310794_founda_0_issue_rules_aaaa0007feed53163610c7233ee0a049</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-01-18 12:00:00</sys_updated_on>
        <type>field_check</type>
    </x_1310794_founda_0_issue_rules>
</record_update>
