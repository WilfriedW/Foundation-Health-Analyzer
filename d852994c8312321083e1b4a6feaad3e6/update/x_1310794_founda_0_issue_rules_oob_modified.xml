<?xml version="1.0" encoding="UTF-8"?><record_update table="x_1310794_founda_0_issue_rules">
    <x_1310794_founda_0_issue_rules action="INSERT_OR_UPDATE">
        <active>true</active>
        <code>OOB_MODIFIED</code>
        <description>Detects out-of-box ServiceNow elements that have been modified by custom users. This is important to identify as modifying OOB elements can cause upgrade issues and should be avoided. Best practice is to clone OOB elements before customizing them.</description>
        <name>Out-of-Box Element Modified</name>
        <params>{"servicenow_users":"system,admin,maint,guest"}</params>
        <script><![CDATA[// Get list of ServiceNow users from params or use default
var snUsers = params.servicenow_users ? 
    params.servicenow_users.split(',').map(function(u) { return u.trim(); }) :
    ['system', 'admin', 'maint', 'guest'];

var createdBy = (item.values.sys_created_by || '').toString();
var updatedBy = (item.values.sys_updated_by || '').toString();
var recordName = item.values.name || item.values.title || 'Record';

// Check if created by ServiceNow user
var isCreatedBySN = snUsers.indexOf(createdBy) !== -1;
// Check if updated by ServiceNow user
var isUpdatedBySN = snUsers.indexOf(updatedBy) !== -1;

// If created by SN but updated by someone else (and they are different)
if (isCreatedBySN && !isUpdatedBySN && createdBy !== updatedBy) {
    var message = 'Out-of-Box record "' + recordName + '" has been modified by ' + updatedBy + 
                  '. Original creator: ' + createdBy + 
                  '. This is a customization of a ServiceNow OOB element.';
    
    issues.push({
        code: rule.code,
        message: message,
        severity: 'high',
        details: {
            record_table: item.table,
            record_sys_id: item.sys_id,
            record_name: recordName,
            sys_created_by: createdBy,
            sys_updated_by: updatedBy,
            sys_package: item.values.sys_package || '',
            sys_scope: item.values.sys_scope || '',
            recommendation: 'Review this customization - modifying OOB elements can cause upgrade issues. Consider cloning the OOB element and customizing the clone instead.'
        }
    });
}]]></script>
        <severity>high</severity>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-01-18 10:00:00</sys_created_on>
        <sys_id>3c8fb0a883563610c7233ee0a04909a1</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-01-18 10:00:00</sys_updated_on>
        <type>oob_modified</type>
    </x_1310794_founda_0_issue_rules>
</record_update>
