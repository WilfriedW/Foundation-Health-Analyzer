<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function($scope, $location, $timeout) {
  var c = this;
    
    // Active section for navigation
    c.activeSection = 'description';
    var sectionIds = ['description','installation','configuration','options','scores','checks','architecture','api','best-practices','resources'];
    var observer = null;
    
    // Set active section
    c.setSection = function(section) {
        c.activeSection = section;
    };
    
    // Scroll to section
    c.scrollToSection = function(sectionId) {
        c.activeSection = sectionId;
        var element = document.getElementById(sectionId);
        if (element) {
            element.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    };

    function setActiveFromViewport(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting && entry.target && entry.target.id) {
                c.activeSection = entry.target.id;
                $scope.$applyAsync();
            }
        });
    }

    function initScrollSpy() {
        if (!('IntersectionObserver' in window)) {
            return;
        }
        if (observer) {
            observer.disconnect();
        }
        observer = new IntersectionObserver(setActiveFromViewport, { threshold: 0.35 });
        sectionIds.forEach(function(id) {
            var el = document.getElementById(id);
            if (el) {
                observer.observe(el);
            }
        });
    }

    $timeout(initScrollSpy, 0);

    $scope.$on('$destroy', function() {
        if (observer) {
            observer.disconnect();
        }
    });
    
    // Go back to dashboard
    c.goToDashboard = function() {
        window.location.href = '/fha?id=fha_homepage';
    };
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.fha-doc-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
}

.fha-doc-header {
    background: linear-gradient(135deg, #1a5a96 0%, #2980b9 100%);
    color: white;
    padding: 40px;
    border-radius: 12px;
    margin-bottom: 30px;
    box-shadow: 0 4px 15px rgba(26, 90, 150, 0.3);
}

.fha-doc-header h1 {
    margin: 0 0 10px 0;
    font-size: 32px;
    font-weight: 600;
}

.fha-doc-header p {
    margin: 0;
    opacity: 0.9;
    font-size: 16px;
}

.fha-doc-nav {
    background: white;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 30px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    position: sticky;
    top: 10px;
    z-index: 100;
}

.fha-doc-nav-title {
    font-size: 14px;
    font-weight: 600;
    color: #666;
    margin-bottom: 15px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.fha-doc-nav-items {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.fha-doc-nav-btn {
    padding: 8px 16px;
    border: none;
    background: #f5f7fa;
    color: #333;
    border-radius: 20px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s;
}

.fha-doc-nav-btn:hover {
    background: #e8f4fc;
    color: #1a5a96;
}

.fha-doc-nav-btn.active {
    background: #1a5a96;
    color: white;
}

.fha-doc-section {
    background: white;
    border-radius: 12px;
    padding: 30px;
    margin-bottom: 25px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

.fha-doc-section h2 {
    color: #1a5a96;
    font-size: 24px;
    margin: 0 0 20px 0;
    padding-bottom: 15px;
    border-bottom: 2px solid #e8f4fc;
    display: flex;
    align-items: center;
    gap: 12px;
}

.fha-doc-section h2 i {
    font-size: 20px;
}

.fha-doc-section h3 {
    color: #333;
    font-size: 18px;
    margin: 25px 0 15px 0;
}

.fha-doc-section p {
    color: #555;
    line-height: 1.7;
    margin-bottom: 15px;
}

.fha-doc-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 14px;
}

.fha-doc-table th {
    background: #f5f7fa;
    padding: 12px 15px;
    text-align: left;
    font-weight: 600;
    color: #333;
    border-bottom: 2px solid #e0e0e0;
}

.fha-doc-table td {
    padding: 12px 15px;
    border-bottom: 1px solid #eee;
    vertical-align: top;
}

.fha-doc-table tr:hover {
    background: #f9fbfd;
}

.fha-severity-badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
}

.fha-severity-high { background: #fee2e2; color: #dc2626; }
.fha-severity-medium { background: #fef3c7; color: #d97706; }
.fha-severity-low { background: #dbeafe; color: #2563eb; }

.fha-score-indicator {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 15px;
    border-radius: 8px;
    font-weight: 600;
}

.fha-score-good { background: #d1fae5; color: #059669; }
.fha-score-warning { background: #fef3c7; color: #d97706; }
.fha-score-critical { background: #fee2e2; color: #dc2626; }

.fha-code-block {
    background: #1e293b;
    color: #e2e8f0;
    padding: 20px;
    border-radius: 8px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 13px;
    overflow-x: auto;
    margin: 15px 0;
}

.fha-code-inline {
    background: #f1f5f9;
    color: #0f172a;
    padding: 2px 8px;
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 13px;
}

.fha-info-box {
    background: #e8f4fc;
    border-left: 4px solid #1a5a96;
    padding: 15px 20px;
    border-radius: 0 8px 8px 0;
    margin: 20px 0;
}

.fha-info-box.warning {
    background: #fef3c7;
    border-left-color: #d97706;
}

.fha-info-box.success {
    background: #d1fae5;
    border-left-color: #059669;
}

/* Architecture Visual Diagram */
.fha-arch-visual {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 30px;
}

.fha-arch-layer {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    padding: 20px;
    text-align: center;
}

.fha-arch-layer-title {
    font-weight: 700;
    font-size: 16px;
    color: #1a5a96;
    margin-bottom: 10px;
}

.fha-arch-ui {
    border-color: #60a5fa;
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
}

.fha-arch-entry {
    border-color: #34d399;
    background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
}

.fha-arch-engine {
    border-color: #fbbf24;
    background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
}

.fha-arch-context {
    border-color: #a78bfa;
    background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);
}

.fha-arch-boxes {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
    margin-top: 10px;
}

.fha-arch-box {
    background: white;
    border: 1px solid #93c5fd;
    border-radius: 6px;
    padding: 10px 15px;
    font-size: 13px;
    font-weight: 500;
    color: #1e40af;
}

.fha-arch-methods {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 10px;
}

.fha-arch-methods code {
    background: rgba(0,0,0,0.05);
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 12px;
    color: #374151;
}

.fha-arch-desc {
    font-size: 13px;
    color: #6b7280;
}

.fha-arch-arrow {
    text-align: center;
    padding: 10px 0;
    color: #9ca3af;
    font-size: 20px;
}

.fha-arch-checks {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.fha-arch-check {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    padding: 15px;
}

.fha-arch-check-title {
    font-weight: 600;
    font-size: 14px;
    color: #1a5a96;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid #e5e7eb;
}

.fha-arch-check-title i {
    margin-right: 6px;
}

.fha-arch-check ul {
    margin: 0;
    padding-left: 18px;
    font-size: 12px;
    color: #4b5563;
}

.fha-arch-check li {
    margin-bottom: 4px;
}

.fha-option-card {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 20px;
    margin: 15px 0;
}

.fha-option-card h4 {
    color: #1a5a96;
    margin: 0 0 10px 0;
    display: flex;
    align-items: center;
    gap: 8px;
}

.fha-option-card p {
    margin: 0;
    color: #666;
    font-size: 14px;
}

.fha-feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.fha-feature-card {
    background: #f8fafc;
    border-radius: 8px;
    padding: 20px;
    border: 1px solid #e2e8f0;
}

.fha-feature-card h4 {
    color: #1a5a96;
    margin: 0 0 10px 0;
    font-size: 16px;
}

.fha-feature-card ul {
    margin: 0;
    padding-left: 20px;
    color: #555;
    font-size: 14px;
}

.fha-feature-card li {
    margin-bottom: 5px;
}

.fha-doc-subtitle {
    font-size: 15px;
    opacity: 0.95;
}

.fha-doc-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 15px;
    font-size: 12px;
}

.fha-doc-meta-item {
    background: rgba(255, 255, 255, 0.15);
    padding: 6px 10px;
    border-radius: 999px;
    font-weight: 600;
}

.fha-doc-actions {
    margin-top: 18px;
}

.fha-doc-action-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    background: #ffffff;
    color: #1a5a96;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.12);
}

.fha-doc-action-btn:hover {
    background: #e8f4fc;
}

.fha-doc-list {
    margin: 10px 0 0 0;
    padding-left: 18px;
}

.fha-doc-divider {
    height: 1px;
    background: #e8f4fc;
    margin: 20px 0;
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description>Documentation widget for Foundation Health Analyzer</description>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>fha-documentation</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {
  
}]]></link>
        <name>FHA Documentation</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
    data.appVersion = (typeof gs !== 'undefined' && gs.getProperty) ? gs.getProperty('x_1310794_founda_0.version', '1.1.0') : '1.1.0';
    data.lastUpdated = (typeof gs !== 'undefined' && gs.getProperty) ? gs.getProperty('x_1310794_founda_0.doc.last_updated', '2026-01-14') : '2026-01-14';
    data.pageId = '277a975c8392f21083e1b4a6feaad318';
    data.widgetId = '5ada939c8392f21083e1b4a6feaad360';
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2026-01-03 23:57:23</sys_created_on>
        <sys_id>5ada939c8392f21083e1b4a6feaad360</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_name>FHA Documentation</sys_name>
        <sys_package display_value="Foundation Health Analyzer" source="x_1310794_founda_0">d852994c8312321083e1b4a6feaad3e6</sys_package>
        <sys_policy/>
        <sys_scope display_value="Foundation Health Analyzer">d852994c8312321083e1b4a6feaad3e6</sys_scope>
        <sys_update_name>sp_widget_5ada939c8392f21083e1b4a6feaad360</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2026-01-04 01:28:35</sys_updated_on>
        <template><![CDATA[<div class="fha-doc-container">
    <!-- Header -->
    <div class="fha-doc-header">
        <h1><i class="fa fa-book"></i> ${FHA Documentation}</h1>
        <p class="fha-doc-subtitle">${Technical guide for the FHA documentation widget} | ${Version} {{c.data.appVersion}}</p>
        <div class="fha-doc-meta">
            <span class="fha-doc-meta-item">${Page ID}: {{c.data.pageId}}</span>
            <span class="fha-doc-meta-item">${Widget ID}: {{c.data.widgetId}}</span>
            <span class="fha-doc-meta-item">${Scope}: <span class="fha-code-inline">x_1310794_founda_0</span></span>
            <span class="fha-doc-meta-item">${Last updated}: {{c.data.lastUpdated}}</span>
        </div>
        <div class="fha-doc-actions">
            <button class="fha-doc-action-btn" ng-click="c.goToDashboard()">
                <i class="fa fa-arrow-left"></i> ${Back to dashboard}
            </button>
        </div>
    </div>

    <!-- Navigation -->
    <div class="fha-doc-nav">
        <div class="fha-doc-nav-title">${Table of Contents}</div>
        <div class="fha-doc-nav-items">
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'description'}" ng-click="c.scrollToSection('description')">
                <i class="fa fa-info-circle"></i> ${Description}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'installation'}" ng-click="c.scrollToSection('installation')">
                <i class="fa fa-download"></i> ${Installation}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'configuration'}" ng-click="c.scrollToSection('configuration')">
                <i class="fa fa-sliders-h"></i> ${Configuration}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'options'}" ng-click="c.scrollToSection('options')">
                <i class="fa fa-cog"></i> ${Options}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'scores'}" ng-click="c.scrollToSection('scores')">
                <i class="fa fa-chart-pie"></i> ${Scores}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'checks'}" ng-click="c.scrollToSection('checks')">
                <i class="fa fa-check-circle"></i> ${Checks}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'architecture'}" ng-click="c.scrollToSection('architecture')">
                <i class="fa fa-code"></i> ${Architecture}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'api'}" ng-click="c.scrollToSection('api')">
                <i class="fa fa-plug"></i> ${REST API}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'best-practices'}" ng-click="c.scrollToSection('best-practices')">
                <i class="fa fa-shield-alt"></i> ${Best Practices}
            </button>
            <button class="fha-doc-nav-btn" ng-class="{'active': c.activeSection === 'resources'}" ng-click="c.scrollToSection('resources')">
                <i class="fa fa-bookmark"></i> ${Resources}
            </button>
        </div>
    </div>

    <!-- Description Section -->
    <div id="description" class="fha-doc-section">
        <h2><i class="fa fa-info-circle"></i> ${Description}</h2>
        <p>${This Service Portal widget provides interactive, in-portal documentation for the Foundation Health Analyzer application. It ships as the FHA Documentation page and is consumed directly within the portal.}</p>

        <h3>${Quick summary}</h3>
        <ul class="fha-doc-list">
            <li><strong>${Role}:</strong> ${Explain FHA behavior, options, and APIs.}</li>
            <li><strong>${Type}:</strong> ${Service Portal widget (AngularJS) with internal navigation and anchored sections.}</li>
            <li><strong>${Audience}:</strong> ${ServiceNow admins, developers, governance teams.}</li>
        </ul>

        <div class="fha-doc-divider"></div>

        <h3>${Use cases}</h3>
        <div class="fha-feature-grid">
            <div class="fha-feature-card">
                <h4><i class="fa fa-play-circle"></i> ${Run an analysis}</h4>
                <ul>
                    <li>${Understand configuration options}</li>
                    <li>${Identify executed checks per module}</li>
                </ul>
            </div>
            <div class="fha-feature-card">
                <h4><i class="fa fa-chart-line"></i> ${Interpret a score}</h4>
                <ul>
                    <li>${Overall score and severities}</li>
                    <li>${Prioritize remediations}</li>
                </ul>
            </div>
            <div class="fha-feature-card">
                <h4><i class="fa fa-plug"></i> ${Integrate FHA}</h4>
                <ul>
                    <li>${Use the REST API}</li>
                    <li>${Automate analyses}</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Installation Section -->
    <div id="installation" class="fha-doc-section">
        <h2><i class="fa fa-download"></i> ${Installation and access}</h2>
        <p>${This widget ships with the FHA app and requires no npm/pip installation.}</p>

        <h3>${Quick access}</h3>
        <pre class="fha-code-block">/fha?id=fha_documentation</pre>

        <h3>${Prerequisites and roles}</h3>
        <ul class="fha-doc-list">
            <li><span class="fha-code-inline">x_1310794_founda_0.admin</span> ${or} <span class="fha-code-inline">x_1310794_founda_0.user</span></li>
            <li>${Service Portal enabled on the instance}</li>
        </ul>

        <h3>${Dependencies and versions}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Component}</th>
                    <th>${Version}</th>
                    <th>${Notes}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ServiceNow Service Portal</td>
                    <td><span class="fha-code-inline">glide.buildname</span></td>
                    <td>${Provided by the instance (check system property).}</td>
                </tr>
                <tr>
                    <td>AngularJS (embarque)</td>
                    <td><span class="fha-code-inline">glide.buildname</span></td>
                    <td>${Provided by ServiceNow with the portal.}</td>
                </tr>
                <tr>
                    <td>Font Awesome (embarque)</td>
                    <td><span class="fha-code-inline">glide.buildname</span></td>
                    <td>${Uses icons through} <span class="fha-code-inline">fa</span> ${classes.}</td>
                </tr>
            </tbody>
        </table>
        <div class="fha-info-box warning">
            <strong>${Note}:</strong> ${Exact version depends on the instance. Check glide.buildname and glide.builddate to document target compatibility.}
        </div>
    </div>

    <!-- Configuration Section -->
    <div id="configuration" class="fha-doc-section">
        <h2><i class="fa fa-sliders-h"></i> ${Configuration}</h2>
        <p>${The widget does not consume instance parameters. The documentation is rendered statically from the template and server data.}</p>

        <h3>${Widget parameters}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Name}</th>
                    <th>${Type}</th>
                    <th>${Required}</th>
                    <th>${Default}</th>
                    <th>${Description}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="fha-code-inline">widget_parameters</span></td>
                    <td>Object</td>
                    <td>${No}</td>
                    <td>{}</td>
                    <td>${No parameters expected.}</td>
                </tr>
            </tbody>
        </table>

        <h3>${Data exposed to the template}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Name}</th>
                    <th>${Type}</th>
                    <th>${Example}</th>
                    <th>${Description}</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><span class="fha-code-inline">data.appVersion</span></td><td>String</td><td>1.1.0</td><td>${Application version}</td></tr>
                <tr><td><span class="fha-code-inline">data.lastUpdated</span></td><td>String</td><td>2026-01-14</td><td>${Documentation last updated date}</td></tr>
                <tr><td><span class="fha-code-inline">data.pageId</span></td><td>String</td><td>{{c.data.pageId}}</td><td>${Service Portal page ID}</td></tr>
                <tr><td><span class="fha-code-inline">data.widgetId</span></td><td>String</td><td>{{c.data.widgetId}}</td><td>${Service Portal widget ID}</td></tr>
            </tbody>
        </table>

        <h3>${Public methods (client)}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Method}</th>
                    <th>${Signature}</th>
                    <th>${Description}</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><span class="fha-code-inline">setSection</span></td><td>setSection(sectionId)</td><td>${Update active section.}</td></tr>
                <tr><td><span class="fha-code-inline">scrollToSection</span></td><td>scrollToSection(sectionId)</td><td>${Smooth scroll to anchor.}</td></tr>
                <tr><td><span class="fha-code-inline">goToDashboard</span></td><td>goToDashboard()</td><td>${Back to} <span class="fha-code-inline">/fha?id=fha_homepage</span>.</td></tr>
            </tbody>
        </table>

        <h3>${Minimal example}</h3>
        <pre class="fha-code-block">https://&lt;instance&gt;.service-now.com/fha?id=fha_documentation</pre>

        <h3>${Useful system properties}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Property}</th>
                    <th>${Default}</th>
                    <th>${Description}</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><span class="fha-code-inline">x_1310794_founda_0.debug</span></td><td>false</td><td>${Enables FHA server-side debug logging.}</td></tr>
            </tbody>
        </table>
    </div>

    <!-- Options Section -->
    <div id="options" class="fha-doc-section">
        <h2><i class="fa fa-cog"></i> ${Analysis options}</h2>
        <p>${These options are configuration fields on} <span class="fha-code-inline">x_1310794_founda_0_fha_configuration</span>.</p>

        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Option}</th>
                    <th>${Type}</th>
                    <th>${Default}</th>
                    <th>${Effect}</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><span class="fha-code-inline">deep_scan</span></td><td>Boolean</td><td>false</td><td>${Script content analysis}</td></tr>
                <tr><td><span class="fha-code-inline">include_children_tables</span></td><td>Boolean</td><td>false</td><td>${Include child tables}</td></tr>
                <tr><td><span class="fha-code-inline">analyze_references</span></td><td>Boolean</td><td>false</td><td>${Deep reference analysis}</td></tr>
                <tr><td><span class="fha-code-inline">include_ldap</span></td><td>Boolean</td><td>false</td><td>${Full LDAP analysis}</td></tr>
            </tbody>
        </table>
        
        <div class="fha-option-card">
            <h4><i class="fa fa-search-plus"></i> Deep Scan</h4>
            <p>${Detects script quality issues.}</p>
            <div class="fha-info-box">
                <strong>${Detects:}</strong>
                <ul class="fha-doc-list">
                    <li><span class="fha-code-inline">current.update()</span> ${inside Business Rules}</li>
                    <li><span class="fha-code-inline">eval()</span> ${and hardcoded sys_id}</li>
                    <li>${GlideRecord without} <span class="fha-code-inline">setLimit()</span></li>
                </ul>
            </div>
        </div>

        <div class="fha-option-card">
            <h4><i class="fa fa-sitemap"></i> ${Child tables}</h4>
            <p>${Includes tables extending the analyzed table.}</p>
            <div class="fha-info-box">
                <strong>${Example}:</strong> <span class="fha-code-inline">task</span> -> <span class="fha-code-inline">incident</span>, <span class="fha-code-inline">problem</span>, <span class="fha-code-inline">change_request</span>
            </div>
        </div>

        <div class="fha-option-card">
            <h4><i class="fa fa-link"></i> ${Reference analysis}</h4>
            <p>${Checks orphan references and integration dependencies.}</p>
        </div>

        <div class="fha-option-card">
            <h4><i class="fa fa-address-book"></i> ${LDAP analysis}</h4>
            <p>${Recommended for} <span class="fha-code-inline">sys_user</span>, <span class="fha-code-inline">sys_user_group</span>, <span class="fha-code-inline">core_company</span>.</p>
            </div>

        <div class="fha-info-box success">
            <strong>${Good to know}:</strong> ${Options affect processing time and the number of reported issues.}
        </div>
    </div>

    <!-- Scores Section -->
    <div id="scores" class="fha-doc-section">
        <h2><i class="fa fa-chart-pie"></i> ${Health Score}</h2>
        <p>${Health score is calculated out of 100 based on detected issues.}</p>

        <h3>${Calculation}</h3>
        <pre class="fha-code-block">score = 100
for each issue:
  if severity == 'high':   score -= 15
  if severity == 'medium': score -= 5
  if severity == 'low':    score -= 2

return max(0, score)</pre>

        <h3>${Interpretation}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Range}</th>
                    <th>${Status}</th>
                    <th>${Guidance}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="fha-score-indicator fha-score-good"><i class="fa fa-check-circle"></i> 70 - 100</span></td>
                    <td>${Good}</td>
                    <td>${Monitor and address minor items.}</td>
                </tr>
                <tr>
                    <td><span class="fha-score-indicator fha-score-warning"><i class="fa fa-exclamation-circle"></i> 40 - 69</span></td>
                    <td>${Needs attention}</td>
                    <td>${Plan medium/high remediations.}</td>
                </tr>
                <tr>
                    <td><span class="fha-score-indicator fha-score-critical"><i class="fa fa-times-circle"></i> 0 - 39</span></td>
                    <td>${Critical}</td>
                    <td>${Immediate action on high issues.}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Checks Section -->
    <div id="checks" class="fha-doc-section">
        <h2><i class="fa fa-check-circle"></i> ${Analysis Checks}</h2>
        <p>${Checks are grouped by module. Each check returns a code, severity, and metadata.}</p>

        <h3>FHCheckTable</h3>
        <ul class="fha-doc-list">
            <li>${Table structure, custom fields, references}</li>
            <li>${Business Rules and Client Scripts}</li>
        </ul>

        <h3>FHCheckAutomation</h3>
        <ul class="fha-doc-list">
            <li>${Scheduled Jobs, Flows, Workflows, Notifications}</li>
            <li>${UI Actions and UI Policies}</li>
        </ul>

        <h3>FHCheckIntegration</h3>
        <ul class="fha-doc-list">
            <li>${Data Sources, Transform Maps, ACLs, REST APIs}</li>
            <li>${Import Sets and dependencies}</li>
        </ul>

        <h3>${Issue examples}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Code}</th>
                    <th>${Severity}</th>
                    <th>${Description}</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><span class="fha-code-inline">UNUSED_FIELD</span></td><td><span class="fha-severity-badge fha-severity-high">HIGH</span></td><td>${Custom field never populated}</td></tr>
                <tr><td><span class="fha-code-inline">MANY_FLOWS</span></td><td><span class="fha-severity-badge fha-severity-medium">MEDIUM</span></td><td>${Too many flows on the table}</td></tr>
                <tr><td><span class="fha-code-inline">NO_READ_ACL</span></td><td><span class="fha-severity-badge fha-severity-medium">MEDIUM</span></td><td>${No read ACL defined}</td></tr>
                <tr><td><span class="fha-code-inline">CONSOLE_LOG</span></td><td><span class="fha-severity-badge fha-severity-low">LOW</span></td><td>${console.log detected in a script}</td></tr>
            </tbody>
        </table>
    </div>

    <!-- Architecture Section -->
    <div id="architecture" class="fha-doc-section">
        <h2><i class="fa fa-code"></i> ${Technical architecture}</h2>

        <h3>${Diagram (HTML)}</h3>
        <div class="fha-arch-visual">
            <div class="fha-arch-layer fha-arch-ui">
                <div class="fha-arch-layer-title">Service Portal (UI Layer)</div>
                <div class="fha-arch-boxes">
                    <div class="fha-arch-box">FHA Dashboard Widget</div>
                    <div class="fha-arch-box">FHA Analysis Results Widget</div>
                    <div class="fha-arch-box">FHA Documentation Widget</div>
                </div>
            </div>
            <div class="fha-arch-arrow"><i class="fa fa-arrow-down"></i></div>
            <div class="fha-arch-layer fha-arch-entry">
                <div class="fha-arch-layer-title">FHAnalyzer</div>
                <div class="fha-arch-methods">
                    <code>getAvailableAnalyses()</code>
                    <code>runAnalysis(configSysId)</code>
                    <code>getAnalysisResult(sysId)</code>
                </div>
            </div>
            <div class="fha-arch-arrow"><i class="fa fa-arrow-down"></i></div>
            <div class="fha-arch-layer fha-arch-engine">
                <div class="fha-arch-layer-title">FHAnalysisEngine</div>
                <div class="fha-arch-desc">${Orchestrates execution via FHCheckRegistry}</div>
            </div>
            <div class="fha-arch-arrow"><i class="fa fa-arrow-down"></i></div>
            <div class="fha-arch-checks">
                <div class="fha-arch-check">
                    <div class="fha-arch-check-title"><i class="fa fa-table"></i> FHCheckTable</div>
                    <ul>
                        <li>Fields &amp; Fill Rates</li>
                        <li>Business Rules</li>
                        <li>Client Scripts</li>
                        <li>Deep Scan</li>
                    </ul>
                </div>
                <div class="fha-arch-check">
                    <div class="fha-arch-check-title"><i class="fa fa-cogs"></i> FHCheckAutomation</div>
                    <ul>
                        <li>Scheduled Jobs</li>
                        <li>Flows</li>
                        <li>Workflows</li>
                        <li>Notifications</li>
                    </ul>
                </div>
                <div class="fha-arch-check">
                    <div class="fha-arch-check-title"><i class="fa fa-exchange"></i> FHCheckIntegration</div>
                    <ul>
                        <li>Data Sources</li>
                        <li>Transform Maps</li>
                        <li>ACLs</li>
                        <li>REST APIs</li>
                    </ul>
                </div>
            </div>
            <div class="fha-arch-arrow"><i class="fa fa-arrow-down"></i></div>
            <div class="fha-arch-layer fha-arch-context">
                <div class="fha-arch-layer-title">FHAnalysisContext</div>
                <div class="fha-arch-desc">${Stores issues, metrics, options}</div>
                <div class="fha-arch-methods">
                    <code>addIssue(code, message, severity, metadata)</code>
                </div>
            </div>
        </div>

        <h3>${Mermaid diagram (if supported)}</h3>
        <pre class="fha-code-block">graph TD
  A[Service Portal] --> B[Widgets FHA]
  B --> C[FHAnalyzer]
  C --> D[FHAnalysisEngine]
  D --> E[FHCheckRegistry]
  E --> F[FHCheckTable]
  E --> G[FHCheckAutomation]
  E --> H[FHCheckIntegration]
  D --> I[FHAnalysisContext]</pre>

        <h3>${Data model}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Table}</th>
                    <th>${Purpose}</th>
                    <th>${Key fields}</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="fha-code-inline">x_1310794_founda_0_fha_configuration</span></td>
                    <td>${Analysis configurations}</td>
                    <td>name, table_reference, deep_scan, include_children_tables, analyze_references</td>
                </tr>
                <tr>
                    <td><span class="fha-code-inline">x_1310794_founda_0_fha_results</span></td>
                    <td>${Analysis results}</td>
                    <td>number, table_name, health_score, issue_found, detail_json, status</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- API Section -->
    <div id="api" class="fha-doc-section">
        <h2><i class="fa fa-plug"></i> ${REST API}</h2>
        <p>${FHA exposes a REST API for automation.}</p>
        
        <h3>${Base URL}</h3>
        <pre class="fha-code-block">https://&lt;instance&gt;.service-now.com/api/x_1310794_founda_0/fha</pre>

        <h3>${Endpoints}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Method}</th>
                    <th>${Endpoint}</th>
                    <th>${Description}</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><span class="fha-severity-badge fha-severity-low">GET</span></td><td><span class="fha-code-inline">/tables</span></td><td>${List configurations}</td></tr>
                <tr><td><span class="fha-severity-badge fha-severity-medium">POST</span></td><td><span class="fha-code-inline">/analyze/{table_name}</span></td><td>${Run analysis by table}</td></tr>
                <tr><td><span class="fha-severity-badge fha-severity-medium">POST</span></td><td><span class="fha-code-inline">/analyze_by_config/{config_sys_id}</span></td><td>${Run analysis by configuration}</td></tr>
                <tr><td><span class="fha-severity-badge fha-severity-low">GET</span></td><td><span class="fha-code-inline">/analysis/{sys_id}</span></td><td>${Get analysis result}</td></tr>
                <tr><td><span class="fha-severity-badge fha-severity-low">GET</span></td><td><span class="fha-code-inline">/statistics</span></td><td>${Global statistics}</td></tr>
                <tr><td><span class="fha-severity-badge fha-severity-low">GET</span></td><td><span class="fha-code-inline">/history</span></td><td>${Analysis history}</td></tr>
                <tr><td><span class="fha-severity-badge fha-severity-low">GET</span></td><td><span class="fha-code-inline">/fields?table_name={name}</span></td><td>${Fields and fill rate}</td></tr>
                <tr><td><span class="fha-severity-badge fha-severity-low">POST</span></td><td><span class="fha-code-inline">/report/word</span></td><td>${Generate report}</td></tr>
            </tbody>
        </table>

        <h3>${Example: run an analysis}</h3>
        <pre class="fha-code-block">POST /api/x_1310794_founda_0/fha/analyze/incident
Content-Type: application/json
Authorization: Basic &lt;credentials&gt;

{
  "deep_scan": true
}</pre>
    </div>

    <!-- Best Practices Section -->
    <div id="best-practices" class="fha-doc-section">
        <h2><i class="fa fa-shield-alt"></i> ${Best practices and warnings}</h2>
        <ul class="fha-doc-list">
            <li><strong>${Performance}:</strong> ${Enable} <span class="fha-code-inline">deep_scan</span> ${only when needed.}</li>
            <li><strong>${Security}:</strong> ${Restrict access to FHA roles.}</li>
            <li><strong>${Quality}:</strong> ${Prioritize HIGH and MEDIUM issues.}</li>
            <li><strong>${Debug}:</strong> ${Enable} <span class="fha-code-inline">x_1310794_founda_0.debug</span> ${for investigations.}</li>
            <li><strong>${Internationalization}:</strong> ${Labels use the syntax} <span class="fha-code-inline">&#36;{...}</span>.</li>
        </ul>
        <div class="fha-info-box warning">
            <strong>${Warning}:</strong> ${The widget does not validate API rights; ACLs and REST roles must be configured on the platform.}
        </div>
    </div>

    <!-- Resources Section -->
    <div id="resources" class="fha-doc-section">
        <h2><i class="fa fa-bookmark"></i> ${Additional resources}</h2>
        <ul class="fha-doc-list">
            <li><strong>${Widget source}:</strong> <span class="fha-code-inline">sp_widget_5ada939c8392f21083e1b4a6feaad360.xml</span></li>
            <li><strong>${Service Portal page}:</strong> <span class="fha-code-inline">sp_page_277a975c8392f21083e1b4a6feaad318.xml</span></li>
            <li><strong>${Script Includes}:</strong> <span class="fha-code-inline">FHAnalyzer</span>, <span class="fha-code-inline">FHAnalysisEngine</span>, <span class="fha-code-inline">FHCheck*</span></li>
            <li><strong>${API}:</strong> <span class="fha-code-inline">sys_ws_operation_*</span> ${in the update folder}</li>
        </ul>

        <h3>${Changelog}</h3>
        <table class="fha-doc-table">
            <thead>
                <tr>
                    <th>${Version}</th>
                    <th>${Date}</th>
                    <th>${Notes}</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>1.1.0</td><td>2026-01-04</td><td>${Added advanced options (deep scan, child tables, references)}</td></tr>
                <tr><td>1.1.0-doc</td><td>2026-01-14</td><td>${Documentation and structure update.}</td></tr>
                <tr><td>1.0.0</td><td>2026-01-03</td><td>${Initial version}</td></tr>
            </tbody>
        </table>
    </div>

    <!-- Footer -->
    <div style="text-align: center; padding: 30px; color: #666; font-size: 14px;">
        <p>${Foundation Health Analyzer} v{{c.data.appVersion}} | ${Last updated}: {{c.data.lastUpdated}}</p>
        <p>${Built with} ❤️ ${for ServiceNow}</p>
    </div>
</div>]]></template>
    </sp_widget>
</record_update>
